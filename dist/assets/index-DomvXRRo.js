(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(a){if(a.ep)return;a.ep=!0;const n=r(a);fetch(a.href,n)}})();function y(e,t,r){return new Promise((o,a)=>{let n=indexedDB.open(e,t);n.onupgradeneeded=c=>{(c.newVersion??0>t)&&(console.log("Got Version ",c.newVersion,c.oldVersion),a(1)),r(n.result),o(n.result)},n.onsuccess=()=>o(n.result)})}function w(e,t,...r){return h(e,t,(o,a)=>{let n=o.objectStore(t);o.oncomplete=()=>a();for(let c of r)n.add(c)})}function h(e,t,r){return new Promise((o,a)=>{let n=e.transaction(t,"readwrite");n.onerror=()=>a(2),r(n,o)})}const S=1,I="STORAGE";function D(){return y(I,S,E)}function E(e){let t=e.createObjectStore("items",{keyPath:"id"});t.createIndex("name","name",{unique:!1}),t.createIndex("date","date",{unique:!1})}async function N(e,t){return await h(e,"items",((r,o)=>{let n=r.objectStore("items").get(t);console.log("Read Item for ID",t),n.onerror=()=>o(void 0),n.onsuccess=()=>{console.log("Result:",n.result),o(n.result)}}))}function i(e,t,r){let o=document.createElement(e);return o.innerText=r??"",t?.append(o),o}function u(e,...t){return e.classList.add(...t),e}function p(e){for(;e.hasChildNodes();)e.firstChild?.remove()}function O(e,t){let r=u(i("main",document.body),"container"),o=u(i("header",r),"container");return i("h2",o,"Neuer Gegenstand"),r.appendChild(v(e,t)),r}function v(e,t){let r=i("form"),o=i("fieldset",r),a=i("input",i("label",o,"Gegenstand"));a.oninput=l;let n=i("input",i("label",o,"Nummer"));n.type="number",n.oninput=l;let c=i("input",i("label",o,"Produktionsdatum"));c.type="date",c.valueAsDate=new Date,c.oninput=l;let m=u(i("fieldset",r),"grid"),f=u(i("button",m,"Abbrechen"),"secondary");f.onclick=()=>e("main");let b=i("button",m,"HinzufÃ¼gen");b.onclick=()=>{V({date:c.valueAsDate??new Date,id:n.valueAsNumber,name:a.value},t,e)},l();function l(){b.disabled=n.value==""||c.value==""||a.value=="",f.disabled=n.value!=""||a.value!=""}return r}async function V(e,t,r){try{await w(t.database,"items",e),r("main")}catch{try{let o=await N(t.database,e.id);i("dialog",document.body,JSON.stringify(o))}catch(o){console.log(o)}}}function A(e,t){console.log(t);let r=u(i("main"),"container");return i("header",r,"Main"),i("button",r,"Suchen").onclick=()=>e("search"),i("button",r,"Gegenstand hinzufuegen").onclick=()=>e("edit"),r}function P(e,t){console.log(t);let r=u(i("main"),"container"),o=i("header",r,"Search");return i("button",o,"back").onclick=()=>e("main"),r}document.title="VITE TEST";let d;async function j(){document.body.append(g());try{d=await L(),s(localStorage.getItem("ui-view")||"main")}catch(e){console.error(e)}}let s=e=>{let t;switch(console.log("Show View",e),p(document.body),document.body.append(g()),window.localStorage.setItem("ui-view",e),e){case"search":t=P(s,d);break;case"main":t=A(s,d);break;case"edit":t=O(s,d);break;default:throw Error("Unsupported View "+e)}p(document.body),document.body.append(t)};async function L(){return{database:await D()}}function g(){let e=u(i("main"),"container");return i("article",e).setAttribute("aria-busy","true"),e}j();
